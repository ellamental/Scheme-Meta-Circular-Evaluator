;; (load "/home/trades/Documents/meta/meta-test.chicken")

;; test
;;__________________________________________________________________________;;

(test 1 >>> 1)

;; Single test of expression
(test 
  (+ 1 1) >>> 2)
(test 
  2 >>> (+ 1 1))

;; test multiple expressions
(test 
  1 >>> 1
  2 >>> 2)

(test
  (+ 1 1) >>> 2
  (+ 3 1) >>> 4
  (+ 5 5) >>> 10)

;; test test-environment
(test
  (define a 5) >>> Void
  a >>> 5
  (define a 10) >>> Void
  a >>> 10)



;; define
;;__________________________________________________________________________;;

(test
  (define single-variable 5) 
  >>> Void
  single-variable 
  >>> 5
  
  (define lambda-variable
    (lambda (x) x))
  >>> Void
  (lambda-variable 7)
  >>> 7
  
  (define (single-arg-func x) x)
  >>> Void
  (single-arg-func 3)
  >>> 3
  
  (define (two-arg-func x y) 
    (+ x y)) 
  >>> Void
  (two-arg-func 35 7) 
  >>> 42
  
  ;; Variable argument functions
  (define (variable-args &args) &args) 
  >>> Void
  (variable-args 1) 
  >>> '(1)
  (variable-args 1 2) 
  >>> '(1 2)
  (variable-args "hello" "world") 
  >>> '("hello" "world")
  
  ;; Required arguments and variable arguments
  (define (var-args-1 one &args) one)
  >>> Void
  (var-args-1 42)
  >>> 42
  (var-args-1 42 84)
  >>> 42
  
  (define (var-args-2 one &args) &args)
  >>> Void
  (var-args-2 1)
  >>> '()
  (var-args-2 1 2)
  >>> '(2)
  (var-args-2 1 2 3)
  >>> '(2 3)

 
  
  
  )



;; if
;;__________________________________________________________________________;;

(test
  (if 1 1 0)
  >>> 1
  (if False 1 0)
  >>> 0
)



;; if
;;__________________________________________________________________________;;





;; Make sure error reporting is working.
;; (+ 1 1) != 3 should be the only error reported.
;;__________________________________________________________________________;;

(test (+ 1 1) >>> 3)





